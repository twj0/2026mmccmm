# =============================================================================
# MCM 2026 Problem C - DWTS 建模配置文件
# =============================================================================
# 
# 这个配置文件就像是我们整个DWTS建模系统的"控制面板"
# 想象一下，我们要分析34季《与星共舞》的数据，但是我们只知道：
# - 每周谁被淘汰了
# - 评委给了多少分
# - 但是不知道观众到底投了多少票给谁
# 
# 所以我们要做"数学侦探"，从结果反推过程！
# 这个配置文件就是告诉我们的"侦探算法"该怎么工作的。
#
# 最后更新: 2026-01-30

dwts:
  # =============================================================================
  # 第一题：粉丝投票反推 - 我们的"数学侦探"工作
  # =============================================================================
  # 
  # 想象一下：你看到一个人被淘汰了，你能猜出观众投票的情况吗？
  # 我们的想法是：既然知道评委分数，又知道谁走了，那就能反推粉丝票的大概分布
  # 就像看到地上湿了，推测可能下过雨一样
  q1:
    # 评委vs粉丝的权重平衡 - 这是整个节目的核心！
    # 
    # alpha = 0.5 意思是评委和粉丝各占一半影响力
    # - 如果改成 0.7，就是评委更重要（技术派获胜）
    # - 如果改成 0.3，就是粉丝更重要（人气王获胜）
    # 
    # 现实中DWTS官方说是50-50，所以我们用0.5
    # 但你也可以改成0.4或0.6试试，看结果会不会差很多
    alpha: 0.5
    
    # "软硬程度"控制 - 决定我们的推理有多"死板"
    # 
    # tau = 0.03 意思是：
    # - 大部分时候，分数最低的人确实会被淘汰（符合常理）
    # - 但偶尔也允许一些"意外"，比如Bobby Bones那种情况
    # 
    # 如果设成很小的数（比如0.001），就是"铁律"：最低分必走人
    # 如果设成很大的数（比如1.0），就是"随机"：谁走都有可能
    # 
    # 0.03是个不错的平衡点：既符合常理，又不会太死板
    tau: 0.03
    
    # 抽样数量 - 决定我们"猜测"的精确程度
    # 
    # 想象你要猜一个袋子里红球和蓝球的比例，你抽样越多次，猜得越准
    # 2000次已经够用了，再多的话计算会很慢，再少的话结果可能不稳定
    # 
    # 如果你的电脑很快，可以改成5000试试
    # 如果你的电脑很慢，可以改成1000试试
    prior_draws_m: 2000
    
    # 最终统计用的样本数
    # 
    # 从前面2000个"猜测"里，我们挑500个最靠谱的来算最终结果
    # 这个数字通常是上面那个数字的1/4到1/2
    # 500个已经足够算出稳定的置信区间了
    posterior_resample_r: 500

  # =============================================================================
  # 第二题：规则对比 - 如果换个规则会怎样？
  # =============================================================================
  #
  # DWTS历史上有两种说法：
  # - "百分比相加"：评委分数和粉丝投票都转成百分比，然后相加
  # - "排名相加"：评委排名和粉丝排名直接相加
  # 我们要看看这两种规则会不会产生不同的结果
  q2:
    # 用哪种粉丝投票数据？
    # 
    # percent = 用"份额"的方式（比如张三得30%粉丝票，李四得20%）
    # rank = 用"排名"的方式（比如张三粉丝票第1，李四粉丝票第3）
    # 
    # 大部分时候用percent就行，除非你想专门研究排名规则
    fan_source_mechanism: percent

    # 退赛算不算"离开节目"？
    # 
    # true = 算（不管是被淘汰还是主动退赛，反正都是离开了）
    # false = 不算（只看真正的投票淘汰）
    # 
    # 设成true比较符合观众的感受：反正人走了就是走了
    count_withdraw_as_exit: true

  # =============================================================================
  # 第三题：影响因素分析 - 什么样的人容易获胜？
  # =============================================================================
  #
  # 我们要分析：年龄、职业、家乡、舞伴等因素对成绩的影响
  # 分两条线：技术线（评委喜欢什么）和人气线（观众喜欢什么）
  q3:
    # 用哪种粉丝投票数据来分析？
    # 
    # 和Q2一样，通常用percent就行
    fan_source_mechanism: percent

    # 不确定性分析的强度
    # 
    # 我们不只是算一个平均值，还要算"可能的范围"
    # 15次重复分析已经够了，能给出稳定的置信区间
    # 
    # 如果你想要更精确的结果，可以改成30
    # 如果你想要更快的速度，可以改成10
    n_refits: 15

    # 随机种子 - 保证结果可重复
    # 
    # 就像掷骰子前先说好用哪个骰子，这样别人也能得到同样的结果
    # 这个数字可以是任何整数，20260130是今天的日期
    seed: 20260130

  # =============================================================================
  # 第四题：新规则设计 - 我们能设计更好的投票规则吗？
  # =============================================================================
  #
  # 现在的DWTS规则有问题：技术很差但人气很高的人可能获胜（比如Bobby Bones）
  # 我们要设计新规则，既保护技术水平，又不完全忽视观众意见
  q4:
    # 用哪种粉丝投票数据来测试新规则？
    fan_source_mechanism: percent

    # 每个规则测试多少次？
    # 
    # 我们要模拟"如果用新规则，历史上的比赛会是什么结果"
    # 50次模拟已经够了，能看出规律
    # 
    # 如果你想要更精确，可以改成100
    # 如果你想要更快，可以改成20
    n_sims: 50

    # 随机种子 - 保证模拟结果可重复
    seed: 20260130

    # 压力测试档位 - 测试极端情况
    # 
    # 我们要测试：如果出现"超级人气但技术很差"的选手会怎样？
    # [2.0, 5.0, 10.0] 意思是把这种选手的粉丝票放大2倍、5倍、10倍
    # 
    # 这不是说现实中真的会这样，而是测试我们的新规则够不够"抗压"
    # 就像测试桥梁能承受多大重量一样
    outlier_mults: [2.0, 5.0, 10.0]

    # 高级选项（通常不用改，注释掉就行）
    # 
    # 如果你想测试不同的alpha值，可以取消下面的注释：
    # alpha_grid: [0.3, 0.5, 0.7]
    # 
    # 如果你只想测试某些规则，可以取消下面的注释：
    # mechanisms: [percent, rank]
    # 
    # 如果你只想测试某些季度，可以取消下面的注释：
    # seasons: [27, 28, 29]

# =============================================================================
# 使用说明 - 新手必读！
# =============================================================================

# 🚀 第一次使用：
#    直接用默认设置就行，运行 python run_all.py
#    如果结果看起来合理，就说明配置没问题

# 🔧 如果想调优：
#    1. 先看Q1的ESS比率（有效样本量比率），如果太低（<0.1）就增加prior_draws_m
#    2. 如果Bobby Bones这种争议案例拟合得不好，可以调整tau
#    3. 如果想测试不同的评委/粉丝权重假设，可以调整alpha

# 🧪 敏感性分析（写论文用）：
#    - 测试alpha的影响：试试 [0.3, 0.4, 0.5, 0.6, 0.7]
#    - 测试tau的影响：试试 [0.01, 0.02, 0.03, 0.05, 0.1]
#    每次只改一个参数，看结果变化大不大

# 💻 性能考虑：
#    - 内存使用大约是：prior_draws_m × 活跃选手数 × 8字节
#    - 计算时间大约正比于：prior_draws_m × 周数 × 季数
#    - 如果电脑配置不高，可以先把prior_draws_m改小一点试试

# 📁 输出文件位置：
#    - outputs/predictions/mcm2026c_q1_fan_vote_posterior_summary.csv （粉丝投票估计结果）
#    - outputs/tables/mcm2026c_q1_uncertainty_summary.csv （不确定性分析）
#    - outputs/tables/mcm2026c_q2_mechanism_comparison.csv （规则对比）
#    - outputs/tables/mcm2026c_q3_impact_analysis_coeffs.csv （影响因素分析）
#    - outputs/tables/mcm2026c_q4_new_system_metrics.csv （新规则评估）

# 🆘 常见问题：
#    - 如果程序跑得很慢：减小prior_draws_m和n_sims
#    - 如果结果不稳定：增加prior_draws_m和posterior_resample_r
#    - 如果Bobby Bones案例拟合不好：增加tau（比如改成0.05）
#    - 如果想要更保守的技术保护：增加alpha（比如改成0.6）