- 要标记出哪里放哪个图片，图片名写上，图片在`Simulation/25C/Coder/问题一/figures`查看


# 1 Introduction 
## 1.1 Problem Background

奥运奖牌榜是衡量国家体育实力与资源配置效果的关键指标。2024年巴黎夏季奥运会中，美国以126枚奖牌（40金）领跑，中国金牌40枚并列第一，东道主法国金牌16枚（第5）总奖牌64枚（第4），英国金牌14枚却总奖牌65枚列第3。这些结果凸显经济、人口、传统、项目结构及主场优势的影响。

尽管强国格局稳定，巴黎奥运首次夺牌国（如阿尔巴尼亚、佛得角）及超65个从未获奖的国家/地区反映出全球体育成就的不均衡。因此，对2028洛杉矶奥运会的准确预测对各国奥委会的战略规划、突破识别及项目/教练投资至关重要。现存模型多依赖赛前运动员数据，但忽略历史趋势、项目调整及教练流动。本研究构建数据驱动的预测框架，预报奖牌结果、量化教练影响，并为奥委会优化策略提供政策洞见。

## 1.2 Restatement of the Problem

- Task1  
建立各国2028洛杉矶奥运金牌数与总奖牌数的预测模型，并包含不确定性估计与模型性能验证：

  预测2028奖牌榜及变化趋势，识别大幅提升或下降概率最高的国家；
 估算首次获得奥运奖牌的国家数量及概率；

 分析项目数量/类型与奖牌产出的关系，识别各国关键项目及其原因，并评估东 道主项目选择的影响机制。

- Task 2 顶级教练跨国流动常显著影响奖牌产出（如郎平、卡罗伊）：

  提供"伟大教练效应"的证据并估算其对奖牌的贡献量；

  选择三个国家，推荐优先引进优秀教练的项目，并给出预期奖牌增量估算。

- Task 3  
战略启示：从模型中提取有关奥运奖牌动态的独到见解，并为各国奥委会提出基于证据的资源优化与长期规划建议。
## 1.3 Our Work
Ada's graph

# 2. 数据预处理与特征工程 (Data Preprocessing and Feature Engineering)

为了确保预测模型的准确性与鲁棒性，本研究对原始数据集进行了系统的清洗、整合及特征提取。

## 2.1 数据来源与说明

本研究使用的数据源自官方提供的五个核心文件，涵盖了从1896年雅典奥运会至2024年巴黎奥运会的历史记录。数据的时间跨度达128年，共计30届夏季奥运会，涉及164个国家或地区。表1详细列出了本研究所使用的基础数据表及其功能。

<center>**表1：原始数据文件说明**</center>

| 文件名 | 数据内容描述 | 在建模中的主要用途 |
| :--- | :--- | :--- |
| `summerOly_medal_counts.csv` | 历届各国奖牌统计 | 核心预测目标与历史基准 |
| `summerOly_hosts.csv` | 历届奥运会主办城市 | 提取“东道主效应”特征 |
| `summerOly_programs.csv` | 历届比赛项目清单 | 计算奖牌占比及归一化处理 |
| `summerOly_athletes.csv` | 运动员竞赛明细 | 分析项目优势与运动员规模 |
| `data_dictionary.csv` | 字段语义定义 | 确保变量解析的准确性 |

## 2.2 数据清洗与一致性处理

针对原始数据中存在的异质性与潜在噪声，我们实施了以下预处理步骤：

1.  **缺失值识别与处理**：经检测，核心奖牌数据表中不存在缺失记录。对于特定年份未出现在奖牌表中的国家，统一将其奖牌数填充为0，以确保时间序列的完整性。
2.  **历史实体的保留策略**：针对苏联、东德等已解体或改名的历史实体，本研究决定**保留原始记录**而非将其并入现代继承国。原因在于历史表现是重要的预测信号，简单合并会扭曲统计特征。
3.  **文本字符清洗**：针对字段中存在的特殊空格字符（`\xa0`），本研究进行了统一替换与去噪，确保了跨表关联时的匹配准确度。

## 2.3 数据整合与指标归一化

本研究以奖牌统计表为主表，通过左连接（Left Join）方式整合了东道主信息与项目总数。

* **东道主识别**：构建二值变量 $is\_host$。若该国是当届奥运会的东道主，则 $is\_host = 1$，否则为 $0$。
* **奖牌占比归一化**：考虑到历届奥运会项目数量从1896年的43项增至2024年的329项，本研究引入“奖牌占比”指标以实现跨年份的公平比较：
    $$\text{medal\_ratio}_{i,t} = \frac{\text{TotalMedals}_{i,t}}{\text{TotalEvents}_t}$$

## 2.4 特征工程 (Feature Engineering)

本研究基于体育竞技的惯性效应与周期性规律，构建了多维特征矩阵：

### 2.4.1 滞后特征 (Lag Features)
利用过去的成绩预测未来表现，提取了上一届（Lag1）及上两届（Lag2）的奖牌数据：
$$\text{lag}_1(i,t) = \text{TotalMedals}_{i,t-4}$$

### 2.4.2 滚动平均特征 (Rolling Features)
为衡量稳定实力，计算了近三届（约12年周期）的平均奖牌数：
$$\bar{M}_3(i,t) = \frac{1}{3}\sum_{k=1}^{3} \text{TotalMedals}_{i,t-4k}$$

### 2.4.3 衍生统计特征
此外，还构建了参赛届数（$participation\_count$）、金牌占比（$gold\_ratio$）以及奖牌变化量（$total\_change$）等变量。

## 2.5 特征有效性分析

为验证所选特征的解释力，计算了各特征与总奖牌数的相关系数。

<center>**表2：主要特征与奖牌总数的相关性分析**</center>

| 特征变量 | 含义说明 | 相关系数 | 重要性等级 |
| --- | --- | --- | --- |
| `total_rolling3_mean` | 近3届平均奖牌数 | 0.835 | ⭐⭐⭐⭐⭐ |
| `total_lag1` | 上一届奖牌总数 | 0.800 | ⭐⭐⭐⭐⭐ |
| `gold_lag1` | 上一届金牌总数 | 0.791 | ⭐⭐⭐⭐⭐ |
| `is_host` | 是否为东道主 | 0.368 | ⭐⭐⭐ |
| `participation_count` | 历史参赛届数 | 0.232 | ⭐⭐ |

分析结果显示，历史表现特征（滚动平均与滞后项）具有极强的预测价值。最终生成了包含1,435条记录、16个特征字段的结构化分析主表。

# 3 问题一：奖牌预测模型

## 3.1 模型选择与特征分析

### 3.1.1 建模方法选择与适用性论证

奥运奖牌预测本质上是一个数值预测问题，其目标变量（金牌数和总奖牌数）为连续数值型数据。基于这一特征，我们采用回归分析方法而非分类方法进行建模。回归模型能够建立自变量（如历史成绩、东道主效应等）与因变量（奖牌数）之间的数学关系，从而实现对未知值的预测。

我们构建了多元回归预测框架，理由如下：
1. **目标变量连续性**：奖牌数为非负整数，属于连续数值预测范畴
2. **多因素影响**：奖牌分布受经济、人口、历史表现、东道主优势等多重因素共同作用
3. **数据可获取性**：所需特征变量在预测时点均已知，避免数据泄露问题

建模流程遵循"数据探索→特征工程→模型构建→评估优化"的科学路径，具体如图1所示（建模流程图）。

$\textcolor{purple}{【建模流程图】}$

### 3.1.2 探索性数据分析与特征相关性

通过对目标变量（总奖牌数）的分布分析，我们发现：
- **右偏分布特征**：数据呈现显著右偏，大多数国家奖牌数较少（中位数5枚），少数体育强国奖牌数异常高（如图2a所示）
- **均值与中位数差异**：平均奖牌数12.5枚，中位数5枚，表明数据被高奖牌数国家拉高
- **历史趋势**：近三届奥运会平均奖牌数相对稳定（如图2c所示）

$\textcolor{purple}{【目标变量分布图】}$

特征相关性分析显示，历史表现指标（如上届奖牌数、近三届平均奖牌数）与目标变量高度相关，相关系数均超过0.85。我们通过热力图直观展示了各特征间的相关性结构，为后续特征选择提供依据。

$\textcolor{purple}{【热力图】}$

### 3.1.3 东道主效应验证与统计检验

东道主效应（Home Advantage）是奥运奖牌预测中不可忽视的重要因素。我们通过统计方法验证并量化了这一效应：

1. **描述性统计对比**：东道主国家平均获得66.9枚奖牌，显著高于非东道主国家的11.3枚，增幅达491.9%（如图4a所示）

2. **独立样本t检验**：为验证差异的统计显著性，我们进行双样本t检验：
   $$
   t = \frac{\bar{X}_1 - \bar{X}_2}{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}} = 15.0
   $$
   计算得到p值<0.001，远小于显著性水平0.05，拒绝原假设，表明东道主效应统计显著。

3. **效应量分析**：采用Cohen's d衡量效应大小：
   $$
   d = \frac{\bar{X}_1 - \bar{X}_2}{s_{\text{pooled}}} = 2.77
   $$
   根据Cohen标准（d>0.8为大效应），东道主效应属于大效应范畴。

这些分析结果为后续模型中将东道主身份作为重要特征提供了坚实证据。

$\textcolor{purple}{【东道主效应对比图】}$

## 3.2 回归模型构建与评估

### 3.2.1 线性回归与正则化方法（Ridge/Lasso）

我们首先构建多元线性回归作为基线模型：
$$
\hat{y} = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_7 x_7
$$
其中$\hat{y}$为预测奖牌数，$\beta_i$为特征系数，$x_i$为特征值，包括：
- `total_lag1`：上届总奖牌数
- `total_lag2`：上两届总奖牌数  
- `gold_lag1`：上届金牌数
- `total_rolling3_mean`：近三届平均奖牌数
- `is_host`：东道主标识
- `total_events`：当届项目总数
- `participation_count`：参赛届数

针对特征间可能存在的多重共线性问题，我们引入正则化方法：
- **Ridge回归**（L2正则化）：通过惩罚系数平方和防止过拟合
- **Lasso回归**（L1正则化）：通过惩罚系数绝对值实现特征选择

Lasso回归的损失函数为：
$$
L = \sum_{i=1}^{m}(y_i - \hat{y}_i)^2 + \alpha \sum_{j=1}^{n}|\beta_j|
$$
其中$\alpha$为正则化强度参数。

### 3.2.2 集成学习模型（随机森林、梯度提升）

为进一步提升模型性能，我们引入两种集成学习算法：

1. **随机森林**：通过构建多棵决策树并取平均预测，降低过拟合风险。模型能够捕捉特征间的非线性关系，并提供特征重要性排序（如图5所示）。最重要的三个特征为：
   - `gold_lag1`（重要性0.345）
   - `total_lag1`（重要性0.332）
   - `total_rolling3_mean`（重要性0.151）

2. **梯度提升**：采用串行迭代方式，后一棵树专门纠正前一棵树的残差。这种"纠错学习"机制通常能获得更高的预测精度，但也更容易过拟合。

$\textcolor{purple}{【特征重要性图】}$

### 3.2.3 模型评估与性能比较

我们采用多种指标综合评估模型性能：
- **RMSE**（均方根误差）：$\text{RMSE} = \sqrt{\frac{1}{m}\sum_{i=1}^{m}(y_i - \hat{y}_i)^2}$
- **MAE**（平均绝对误差）：$\text{MAE} = \frac{1}{m}\sum_{i=1}^{m}|y_i - \hat{y}_i|$
- **R²**（决定系数）：$R^2 = 1 - \frac{\sum_{i=1}^{m}(y_i - \hat{y}_i)^2}{\sum_{i=1}^{m}(y_i - \bar{y})^2}$

各模型性能对比如下表所示：

| 模型 | RMSE | MAE | R² |
|------|------|-----|-----|
| 线性回归 | 4.58 | 3.00 | 0.945 |
| Ridge回归 | 4.58 | 3.00 | 0.945 |
| **Lasso回归** | **4.45** | **2.88** | **0.948** |
| 随机森林 | 5.20 | 3.17 | 0.930 |
| 梯度提升 | 4.60 | 2.97 | 0.945 |

综合分析表明，Lasso回归在测试集上表现最佳（R²=0.948），且通过特征选择提高了模型解释性。所有模型R²均在0.93以上，表明所选特征对奖牌数有很强的解释力。模型预测值与实际值的散点图显示高度线性相关（如图6所示）。

$\textcolor{purple}{【模型性能对比图】}$

## 3.3 2028年奖牌预测与结果分析

### 3.3.1 奖牌榜预测与置信区间

基于最佳模型（Lasso回归），我们对2028年洛杉矶奥运会奖牌榜进行预测。为确保预测可靠性，我们采用Bootstrap方法计算95%置信区间：

1. **Bootstrap原理**：从训练数据中有放回地重复抽样，构建多个伪训练集
2. **模型重训练**：在每个伪训练集上重新训练Lasso模型
3. **预测分布**：使用所有模型对同一国家进行预测，形成预测值分布
4. **置信区间**：取分布的第2.5%和第97.5%分位数作为95%置信区间：
   $$
   \text{95\% CI} = [\text{Percentile}_{2.5}, \text{Percentile}_{97.5}]
   $$

2028年奖牌榜TOP10预测结果如下（如图7所示）：

| 排名 | 国家 | 2024实际奖牌 | 2028预测奖牌 | 95%置信区间 | 变化 |
|------|------|--------------|--------------|-------------|------|
| 1 | 美国 | 126 | 117 | [89, 179] | -9 |
| 2 | 中国 | 91 | 86 | [67, 108] | -5 |
| 3 | 日本 | 45 | 56 | [35, 101] | +11 |
| 4 | 英国 | 65 | 52 | [43, 68] | -13 |
| 5 | 法国 | 64 | 47 | [36, 56] | -17 |
| 6 | 澳大利亚 | 53 | 46 | [35, 57] | -7 |
| 7 | 意大利 | 40 | 40 | [35, 50] | 0 |
| 8 | 加拿大 | 27 | 38 | [26, 47] | +11 |
| 9 | 荷兰 | 34 | 37 | [30, 43] | +3 |
| 10 | 德国 | 33 | 32 | [24, 42] | -1 |

**关键发现**：
1. **美国主场优势**：作为东道主，美国预计获得117枚奖牌，虽有下降但仍领先
2. **法国显著下滑**：失去东道主优势后，法国奖牌数预计从64枚降至47枚
3. **亚洲力量上升**：日本、加拿大等国家预计有两位数增长

置信区间可视化（如图8）显示，预测不确定性随奖牌数增加而增大，强国预测区间更宽。

$\textcolor{purple}{【2028预测奖牌榜图】}$
$\textcolor{purple}{【置信区间图】}$

### 3.3.2 首次获奖国家预测与概率估计

首次获奖国家数量符合稀有事件发生特征，我们采用泊松分布进行建模：
$$
P(X = k) = \frac{\lambda^k e^{-\lambda}}{k!}
$$
其中$X$为首次获奖国家数，$\lambda$为平均发生率。

基于2000年以来历史数据（平均每届5.7个国家首次获奖），设置$\lambda=5.8$，得到2028年预测分布：

| 首次获奖国家数 | 概率 | 累积概率 |
|---------------|------|----------|
| ≤3 | 17.00% | 17.00% |
| 4 | 14.28% | 31.27% |
| **5** | **16.56%** | **47.83%** |
| **6** | **16.01%** | **63.84%** |
| 7 | 13.26% | 77.10% |
| ≥8 | 22.90% | 100.00% |

**预测结论**：
1. **期望值**：5.8个国家（约6个）
2. **90%预测区间**：[2, 10]个国家
3. **最可能结果**：5-6个国家首次获奖（概率32.57%）

这一预测与历史趋势基本一致（如图9所示），反映了奥运奖牌分布缓慢分散化的长期趋势。

$\textcolor{purple}{【首次获奖预测图】}$

## 3.4 奥运项目与获奖关联分析

### 3.4.1 各国优势项目识别

通过对各国历史奖牌数据的项目分析，我们识别出主要体育强国的优势项目：

| 国家 | 优势项目（历史奖牌总数） | 特点分析 |
|------|-------------------------|----------|
| 美国 | 游泳(1206)、田径(1190)、篮球(389)、赛艇(388)、射击(207) | 全面强盛，基础大项优势明显 |
| 中国 | 游泳(120)、跳水(119)、体操(109)、乒乓球(104)、羽毛球(83) | 技巧类项目突出，小球项目强势 |
| 英国 | 田径(393)、赛艇(319)、自行车(182)、曲棍球(181)、游泳(157) | 场地项目优势，自行车传统强项 |
| 德国 | 赛艇(252)、曲棍球(200)、田径(165)、皮划艇(163)、游泳(160) | 水上项目突出，集体项目稳定 |

优势项目形成受多重因素影响：
1. **历史传统**：长期积累的训练体系和人才储备
2. **资源投入**：国家体育政策对特定项目的倾斜
3. **群众基础**：项目在本国的普及程度和参与人口
4. **地理环境**：自然条件对训练的影响（如北欧国家冬季项目强）

### 3.4.2 项目数量对奖牌分布的影响

奥运会项目数量从1896年的43个增加至2024年的329个，这一变化对奖牌分布产生显著影响：

1. **奖牌分散化效应**：项目增加为更多国家提供获奖机会
   - 早期奥运会：奖牌集中于少数传统强国
   - 现代奥运会：获奖国家数量显著增加，小国通过优势项目突破

2. **东道主项目策略**：主办国可适度影响项目设置
   - **新增本国优势项目**：提高本土运动员获奖概率
   - **调整比赛规则**：适应本国运动员技术特点
   - **场地设施优势**：提前适应比赛环境

3. **项目类型与奖牌产出关系**：不同项目奖牌产出效率差异显著
   - **高产项目**：游泳、田径等项目奖牌数多，竞争激烈
   - **特色项目**：部分国家在特定项目上形成垄断优势

项目数量与获奖国家数的正相关关系表明，奥运会项目扩张促进了全球体育发展的均衡性，为更多国家提供了展示体育实力的平台。
