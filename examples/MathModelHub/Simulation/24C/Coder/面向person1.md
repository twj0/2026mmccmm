# 2024 MCM C题 完整写作指南

> **阅读对象**: 写作手Person1（假设无任何建模基础）
> 
> 本文档将从零开始，帮助你理解这道题在问什么、我们是怎么解决的、以及如何利用Coder文件夹中的材料完成论文写作。

---

## 第一部分：读懂题目——这道题到底在问什么？

### 1.1 背景故事

2023年温网男单决赛，20岁的新星**阿尔卡拉斯**对阵36岁的传奇**德约科维奇**。

比赛过程非常戏剧化：
- **第一盘**: 德约科维奇 6-1 完胜（看起来要横扫）
- **第二盘**: 阿尔卡拉斯 7-6 抢七险胜（局势逆转）
- **第三盘**: 阿尔卡拉斯 6-1 完胜（彻底翻盘？）
- **第四盘**: 德约科维奇 6-3 扳回（又逆转了！）
- **第五盘**: 阿尔卡拉斯 6-4 获胜（最终夺冠）

**问题来了**: 为什么比赛局势会这样来回波动？这种"谁占优势"的变化，就是我们说的**势头(Momentum)**。

### 1.2 四个子问题的通俗解释

| 问题 | 通俗理解 | 核心任务 |
|------|----------|----------|
| **问题一** | 怎么衡量"谁在占优势"？ | 设计一个"势头分数"来量化局势，并画出势头变化曲线 |
| **问题二** | 势头是真的存在，还是纯靠运气？ | 用统计学证明势头不是随机现象 |
| **问题三** | 什么情况下势头会转变？ | 找出导致势头转变的关键因素，给教练建议 |
| **问题四** | 这个模型靠不靠谱？ | 测试模型在其他比赛中是否有效，讨论能否用于其他运动 |

### 1.3 数据说明

题目提供的数据是2023温网男单**第二轮之后**所有比赛的**逐分记录**，包含：
- 32场比赛，7284个得分点
- 每个得分点的详细信息：比分、发球方、得分方式、跑动距离等

---

## 第二部分：我们的解题思路——每个问题怎么解决的

### 2.1 问题一：如何量化势头？

**核心思路**: 借鉴国际象棋的ELO评分系统，设计一个**动态势头评分模型(DMS)**。

**模型工作原理**（用大白话解释）：
1. 比赛开始时，势头分数 = 0（双方平衡）
2. 每赢一分，赢方的势头增加，输方减少
3. **关键设计**：
   - **发球方赢**：势头变化小（因为发球方本来就该赢）
   - **接发方赢**：势头变化大（因为接发方赢更"意外"，更能体现势头）
   - **破发点/盘点**：这种关键分，势头变化更大
   - **连胜**：连赢多分时，每赢一分势头增加得更多
   - **衰减**：势头会随时间自然衰减（不能一直高下去）

**数学公式**（论文中需要写的）:
$$M_t = M_{t-1} + \Delta M_t - \gamma M_{t-1}$$

其中 $M_t$ 是第t分后的势头值，$\Delta M_t$ 是这一分带来的势头变化，$\gamma$ 是衰减系数。

**结果**: 
- 模型预测比赛胜者准确率：**90.3%**
- 势头为正 → 选手1占优；势头为负 → 选手2占优

### 2.2 问题二：势头是真实存在的吗？

**核心思路**: 如果势头只是随机现象，那么"连胜"应该是随机分布的。我们用统计检验来验证。

**我们做了三种检验**:

#### (1) 游程检验 (Runs Test)
- **什么是游程**: "连胜"或"连败"算一个游程。比如"赢赢赢输输赢"有3个游程。
- **检验逻辑**: 如果得分是纯随机的，游程数应该接近理论期望值。如果实际游程数显著偏少，说明存在"连胜聚集"现象。
- **结果**: 游程数显著少于随机期望 (p < 0.05)，说明连胜不是偶然的。

#### (2) 条件概率检验
- **检验逻辑**: 比较"刚赢完一分后，下一分再赢的概率"与"总体胜率"
- **结果**: 
  - 赢后再赢概率: 54.4%
  - 总体胜率: 51.0%
  - 差异显著 (p < 0.001)
- **结论**: 存在"热手效应"——赢了一分后更容易继续赢

#### (3) 卡方检验
- 进一步验证条件概率的差异是统计显著的

**总结论**: 统计证据强烈支持势头是**真实存在**的现象，不是随机波动。

### 2.3 问题三：什么因素导致势头转变？

**核心思路**: 用机器学习模型预测"势头什么时候会转变"，然后看哪些因素最重要。

**我们的做法**:
1. **定义势头转变**: 势头分数从正变负，或从负变正
2. **建立预测模型**: 使用随机森林分类器
3. **分析特征重要性**: 看哪些因素对预测最有帮助

**发现的关键因素**（按重要性排序）:
| 排名 | 因素 | 解释 |
|------|------|------|
| 1 | 当前势头值 | 势头越极端，越容易回调 |
| 2 | 回合击球数 | 长回合后更容易发生势头转变 |
| 3 | 得分差 | 分差悬殊时势头容易变化 |
| 4 | 是否破发点 | 破发点是关键节点 |
| 5 | 连胜长度 | 连胜太长容易被打断 |

**模型性能**: AUC = 0.945（非常好的预测效果）

**给教练的建议**:
1. 破发点是势头转折的关键时刻，要特别重视
2. 建立连胜后要保持专注，不要松懈
3. 落后时不要放弃，比赛后期势头更不稳定
4. 关注对手的连胜，设法尽早打断

### 2.4 问题四：模型能推广吗？

**核心思路**: 用"留一比赛交叉验证"测试模型的泛化能力。

**什么是留一验证**: 每次用31场比赛训练模型，预测剩下的1场，重复32次。这样可以评估模型对"没见过的比赛"的预测能力。

**结果**:
- 留一验证AUC: 0.941
- 胜者预测准确率: 90.0%
- 各轮次表现稳定（从第二轮到决赛都有效）

**适用性讨论**:
| 场景 | 适用性 | 说明 |
|------|--------|------|
| 其他男子网球比赛 | 高 | 规则相同，可直接应用 |
| 女子网球 | 中高 | 需调整发球优势参数 |
| 其他大满贯 | 中高 | 场地不同，参数可能需微调 |
| 乒乓球 | 中 | 回合更短，需重新设计 |
| 团队运动 | 低 | 需引入更多变量 |

---

## 第三部分：核心概念解释（写论文时需要理解的术语）

### 3.1 网球术语

| 术语 | 英文 | 解释 |
|------|------|------|
| 盘 | Set | 一场比赛由多盘组成，温网男单采用五盘三胜制 |
| 局 | Game | 一盘由多局组成，先赢6局（且领先2局以上）赢得一盘 |
| 分 | Point | 一局由多分组成，先得4分（且领先2分以上）赢得一局 |
| 发球 | Serve | 每局由一方发球，发球方有优势 |
| 破发 | Break | 接发球方赢得一局，打破对方发球局 |
| 破发点 | Break Point | 接发球方再赢一分就能破发的关键时刻 |
| 抢七 | Tie-break | 比分6-6时的加赛，决定这一盘的胜负 |

### 3.2 统计术语

| 术语 | 解释 |
|------|------|
| 游程检验 (Runs Test) | 检验序列是否随机的统计方法 |
| 条件概率 | 在某条件下发生某事的概率，如"赢了一分后再赢的概率" |
| 卡方检验 | 检验两个变量是否相关的统计方法 |
| AUC | 模型预测效果的指标，范围0-1，越接近1越好 |
| 交叉验证 | 评估模型泛化能力的方法 |

### 3.3 模型术语

| 术语 | 解释 |
|------|------|
| 随机森林 | 一种机器学习算法，由多棵决策树组成 |
| 特征重要性 | 衡量每个输入变量对预测的贡献程度 |
| 过拟合 | 模型在训练数据上表现好，但在新数据上表现差 |
| 鲁棒性 | 模型对参数变化和数据噪声的抵抗能力 |

---

## 第四部分：如何使用Coder文件夹写论文

### 4.1 文件夹结构说明

```
Coder/
├── 数据处理/                    # 数据预处理代码和结果
│   ├── data_preprocessing.ipynb
│   ├── processed_wimbledon_data.csv     # 清洗后的数据
│   └── processed_wimbledon_with_momentum.csv  # 带势头分数的数据
│
├── 问题一/                      # 势头模型
│   ├── 问题一建模分析.ipynb
│   ├── match_momentum_stats.csv  # 各比赛势头统计
│   └── figures/
│       ├── fig1_final_momentum_curve.pdf  ⭐ 决赛势头曲线（最重要）
│       ├── fig2_momentum_heatmap.pdf      分盘势头热力图
│       └── fig5_momentum_vs_result.pdf    势头与比赛结果关系
│
├── 问题二/                      # 统计检验
│   ├── 问题二建模分析.ipynb
│   └── figures/
│       ├── fig1_runs_test_distribution.pdf  游程检验结果
│       └── fig2_conditional_probability.pdf ⭐ 条件概率对比（重要）
│
├── 问题三/                      # 预测模型
│   ├── 问题三建模分析.ipynb
│   ├── feature_importance.csv   # 特征重要性数据
│   └── figures/
│       ├── fig1_roc_curve.pdf           ROC曲线
│       └── fig2_feature_importance.pdf  ⭐ 特征重要性（重要）
│
├── 问题四/                      # 模型泛化
│   ├── 问题四建模分析.ipynb
│   └── figures/
│       ├── fig1_lomo_results.pdf     留一验证结果
│       └── fig3_applicability.pdf    适用性评分
│
├── 敏感性分析/                  # 参数敏感性
│   ├── 敏感性分析.ipynb
│   └── figures/
│       ├── fig1_momentum_params_sensitivity.pdf  势头模型参数敏感性
│       ├── fig2_rf_params_sensitivity.pdf        随机森林参数敏感性
│       ├── fig4_dual_param_heatmap.pdf           双参数热力图
│       └── fig5_sensitivity_summary.pdf          敏感性汇总
│
├── 面向person1.md              # 本文档
└── 面向person2.md              # 资料手指南
```

### 4.2 论文结构建议

```
1. Summary (摘要，1页)
   - 问题背景、方法、主要结论

2. Introduction (引言)
   - 网球比赛中势头的背景
   - 问题陈述
   - 我们方法的概述

3. Methodology (方法论) ← 重点章节
   3.1 数据预处理与特征工程
   3.2 动态势头评分模型 (DMS)
   3.3 势头真实性的统计检验
   3.4 势头转变预测模型
   3.5 模型泛化测试方法

4. Results (结果) ← 重点章节
   4.1 势头可视化 (对应问题一)
   4.2 势头真实性的统计证据 (对应问题二)
   4.3 势头转变预测 (对应问题三)
   4.4 模型泛化验证 (对应问题四)

5. Sensitivity Analysis (敏感性分析)
   - 参数敏感性测试
   - 模型鲁棒性结论

6. Discussion (讨论)
   6.1 主要发现
   6.2 对教练的实际建议
   6.3 模型局限性
   6.4 对其他运动的适用性

7. Conclusion (结论)

8. Memo to Coaches (备忘录，1-2页)

9. References (参考文献)

10. AI Use Report (如使用AI)
```

### 4.3 每个章节该用哪些图？

| 章节 | 推荐使用的图 | 图片路径 |
|------|-------------|----------|
| 4.1 Results - Q1 | 决赛势头曲线 | `问题一/figures/fig1_final_momentum_curve.pdf` |
| 4.1 Results - Q1 | 分盘势头热力图 | `问题一/figures/fig2_momentum_heatmap.pdf` |
| 4.1 Results - Q1 | 势头与比赛结果 | `问题一/figures/fig5_momentum_vs_result.pdf` |
| 4.2 Results - Q2 | 游程检验分布 | `问题二/figures/fig1_runs_test_distribution.pdf` |
| 4.2 Results - Q2 | 条件概率对比 | `问题二/figures/fig2_conditional_probability.pdf` |
| 4.3 Results - Q3 | ROC曲线 | `问题三/figures/fig1_roc_curve.pdf` |
| 4.3 Results - Q3 | 特征重要性 | `问题三/figures/fig2_feature_importance.pdf` |
| 4.4 Results - Q4 | 留一验证结果 | `问题四/figures/fig1_lomo_results.pdf` |
| Discussion | 适用性评分 | `问题四/figures/fig3_applicability.pdf` |
| Sensitivity | 参数敏感性 | `敏感性分析/figures/fig1_momentum_params_sensitivity.pdf` |
| Sensitivity | 敏感性汇总 | `敏感性分析/figures/fig5_sensitivity_summary.pdf` |

### 4.4 关键数据（可直接引用）

**问题一结果**:
- 势头模型预测比赛胜者准确率: **90.3%** (28/31场正确)
- 决赛中阿尔卡拉斯势头范围: -12.09 ~ +24.66

**问题二结果**:
- 游程比率: 0.935 < 1.0，说明连胜多于随机期望
- 赢后再赢概率: **54.4%** vs 总体胜率 **51.0%**
- 卡方检验: p < 0.001

**问题三结果**:
- 预测模型AUC: **0.945**
- 交叉验证AUC: 0.924 ± 0.022
- 最重要因素: 当前势头值、回合长度、得分差

**问题四结果**:
- 留一验证AUC: **0.941**
- 留一验证准确率: **90.0%**

**敏感性分析结果**:
- 最敏感参数: 发球优势因子 (敏感度 0.110)
- 其他参数敏感度均 < 0.05，模型鲁棒

---

## 第五部分：论文写作实用指南

### 5.1 公式的LaTeX写法

**势头更新公式**:
```latex
M_t = M_{t-1} + \Delta M_t - \gamma M_{t-1}
```

**势头变化量**:
```latex
\Delta M_t = w_{\text{base}} \cdot w_{\text{serve}} \cdot w_{\text{key}} \cdot w_{\text{streak}}
```

**条件概率**:
```latex
P(\text{Win}_t | \text{Win}_{t-1}) > P(\text{Win})
```

### 5.2 常用英文表达

**描述模型**:
- "We develop a Dynamic Momentum Score (DMS) model that captures the ebb and flow of match dynamics."
- "The model incorporates serve advantage, key point weighting, and streak bonuses."
- "Momentum is updated after each point using an ELO-inspired mechanism."

**描述统计结果**:
- "Statistical tests strongly reject the null hypothesis that momentum is random."
- "The runs test reveals significantly fewer runs than expected (p < 0.05), indicating clustering of winning streaks."
- "Conditional probability analysis shows that winning probability increases by 3.4% after a previous win."

**描述预测模型**:
- "The Random Forest classifier achieves an AUC of 0.945 in predicting momentum shifts."
- "Feature importance analysis reveals that current momentum state is the strongest predictor."
- "The model demonstrates robust generalization with a leave-one-match-out AUC of 0.941."

**描述敏感性**:
- "Sensitivity analysis confirms the model's robustness across parameter variations."
- "The serve advantage factor shows the highest sensitivity, requiring careful calibration."

### 5.3 备忘录(Memo)写作要点

备忘录是写给**教练**看的，要求：
1. **语言简洁**: 避免技术术语，用教练能懂的话
2. **实用导向**: 强调可操作的建议
3. **结构清晰**: 便于快速阅读

**建议内容框架**:
```
致: 网球教练
来自: [团队名]
主题: 关于比赛中"势头"的研究发现与建议

一、核心发现
- 势头是真实存在的（不是随机）
- 我们能够预测势头何时会转变

二、关键时刻
- 破发点是势头转折的关键
- 长回合后更容易发生势头变化
- 比赛后期势头更不稳定

三、给教练的建议
1. [具体建议1]
2. [具体建议2]
3. [具体建议3]

四、给球员的心理准备建议
...
```

---

## 第六部分：常见问题解答

### Q1: 我不懂代码，能写论文吗？
**A**: 完全可以。你只需要理解模型的思路和结果，不需要理解具体代码。本文档已经把所有关键信息整理好了。

### Q2: 图片怎么插入论文？
**A**: 所有图片都是PDF格式，可以直接插入LaTeX或Word。路径在上面的表格中已列出。

### Q3: 数值结果从哪里找？
**A**: 
- 关键数值已在本文档4.4节列出
- 详细数据可查看各问题文件夹中的CSV文件
- 也可以运行对应的.ipynb文件查看完整输出

### Q4: 论文需要多少页？
**A**: 题目要求不超过25页（不含AI使用报告）。建议分配：
- 摘要: 1页
- 正文: 18-20页
- 参考文献: 1-2页
- 备忘录: 1-2页

### Q5: 公式需要自己推导吗？
**A**: 不需要。公式已经设计好，你只需要在论文中清晰地呈现它们，并解释每个符号的含义。

---

## 附录：参数速查表

### 势头模型参数

| 参数 | 符号 | 默认值 | 含义 |
|------|------|--------|------|
| 基础权重 | $w_{\text{base}}$ | 1.0 | 每分的基础势头变化 |
| 发球优势 | $p_{\text{serve}}$ | 0.65 | 发球方获胜的权重调整 |
| 破发点权重 | $w_{\text{break}}$ | 1.5 | 破发点的额外权重 |
| 连胜加成 | $w_{\text{streak}}$ | 0.1 × streak | 连胜时的额外加成 |
| 衰减率 | $\gamma$ | 0.02 | 势头向零回归的速度 |

### 预测模型参数

| 参数 | 默认值 | 说明 |
|------|--------|------|
| 树数量 | 100 | 随机森林中决策树的数量 |
| 最大深度 | 10 | 每棵树的最大深度 |
| 最小样本分割 | 20 | 分裂节点需要的最小样本数 |

---

**最后提醒**: 如有任何疑问，可以查看对应的Jupyter Notebook文件，里面有详细的注释和输出结果。祝写作顺利！
