# Q3：特征影响分析（Impact of Celebrities + Pro Dancers）

## 0. 我对题目的理解（聚焦 Q3）

题目要求“使用包含 fan vote estimates 的数据”来分析：

- 各类 **celebrity 特征**（年龄、行业、地区等）和 **pro dancer**（舞伴）对比赛表现的影响。
- 这些因素对 **评委分（技术线）** 与 **粉丝票（人气线）** 的影响是否一致。

核心思路：把结果拆成两条因变量分别建模，避免把“技术”和“人气”混成一个黑盒。

## 1. 数据可信度与可用性检查（与 Q3 相关）

- 官方数据提供的 celebrity 静态特征与 pro dancer 信息可信且覆盖全季。
- 粉丝票并非观测量，来自 Q1 推断，因此：
  - Q3 必须把 Q1 的不确定性带入（至少以：使用后验均值 + 用 bootstrap/多后验样本重复拟合的方式给区间）。
- 外生人气 proxy：
  - Wikipedia Pageviews 方法可信，但历史覆盖从 ~2015-07 开始；且当前落盘文件规模较小，可能尚未覆盖全部可覆盖赛季。
  - Google Trends 不稳定且覆盖有限（并且早期大量 error）。
  - 结论：Q3 主线不应依赖外生 proxy 全覆盖；应设计“有则用、无则缺失”的特征工程与稳健性对照。

## 2. 建模数据结构（概念层）

建议使用两张表：

### 2.1 weekly panel（用于动态表现）

- 粒度：`season, week, celebrity_name`
- 包含：
  - `judge_score_total`, `judge_score_pct`, `judge_rank`
  - `fan_vote_share` / `fan_vote_index`（来自 Q1 的后验汇总）
  - `ballroom_partner`（pro dancer）
  - `active`, `eliminated_this_week`

### 2.2 season features（用于赛季层总结）

- 粒度：`season, celebrity_name`
- 包含：
  - `celebrity_age_during_season`
  - `celebrity_industry`
  - `celebrity_homestate`, `celebrity_homecountry/region`
  - pro dancer：可保留 `ballroom_partner`（或做 pro 的赛季固定）
  - 外生 proxy（可选）：`wiki_pageviews_*`, `trends_*`, `state_population_2020`

## 3. 两条因变量：技术线 vs 人气线

### 3.1 技术线（Judges）

候选因变量（选其一主线 + 其余作稳健性对照）：

- 周级：`yJ_{s,t,i} = judge_score_pct_{s,t,i}`
- 季级：`yJ_{s,i} = mean_t(judge_score_pct_{s,t,i})` 或决赛周 `judge_score_pct`。

### 3.2 人气线（Fans, from Q1）

候选因变量：

- 周级：`yF_{s,t,i} = fan_vote_index_{s,t,i}`（建议 `logit(pF)` 或 z-score）
- 季级：`yF_{s,i} = mean_t(fan_vote_index_{s,t,i})` 或 “进决赛/夺冠概率”。

强调：`yF` 不是观测值，而是 Q1 后验导出的随机量；因此 Q3 需要不确定性传播。

## 4. 特征工程（可解释优先）

### 4.1 结构化特征

- `age`：数值；可加 `age^2` 捕捉非线性（是否太老/太年轻影响）。
- `industry`：类别变量（One-hot）。
- `homecountry/region`：类别；或简化成 `is_us` + country。
- `homestate`：仅对美国选手；可与 `state_population` 合并（注意 `Washington D.C.` -> `District of Columbia`）。

### 4.2 pro dancer 特征（核心）

同一 pro 会跨季重复出现 → 典型的“重复测量/层级结构”。

- 直觉：pro 可能既提升技术（训练能力），也可能自带粉丝（人气加成）。

### 4.3 外生人气 proxy（可选）

- wiki pageviews：可作为粉丝线的解释变量，也可作为 Q1 先验强度来源。
- trends：仅对 `status==ok & n_points>0` 的行可用；缺失则留空，不强行填补。

## 5. 模型选择（从 baseline 到加分）

### 5.1 Baseline（快速可复现）

- 线性/岭回归：
  - `yJ ~ age + industry + is_us + ...`
  - `yF ~ age + industry + is_us + wiki_pageviews + ...`
- 优点：解释清晰、实现简单、可作为主线对照。

### 5.2 加分模型：混合效应 / 层级模型（推荐）

#### (A) 随机截距（random intercept）

- 技术线：
  - `yJ_{s,t,i} = X_{s,t,i} beta + u_{pro(i)} + u_{season(s)} + eps`
- 人气线：
  - `yF_{s,t,i} = X'_{s,t,i} gamma + v_{pro(i)} + v_{season(s)} + eps`

其中：
- `u_{pro}` / `v_{pro}` 是 pro dancer 随机效应（解释为“该舞伴平均能带来多少加成”）。
- 加 `season` 随机效用于吸收赛制/观众结构随时间变化。

#### (B) 随机斜率（可选炫技）

例如 `industry` 在不同 season 影响不同，或 pro 对不同类型 celebrity 的提升不同：

- `yJ = ... + (1 + age | pro)`

这部分写在扩展/附录更稳妥，避免过拟合。

## 6. 不确定性与验证（必须写清）

### 6.1 Q1 不确定性如何传递到 Q3

提供两种可写进论文的做法：

- **后验重复拟合**：从 Q1 后验抽样 K 次，每次得到一份 `fan_vote_index` 表，重复拟合 Q3，最后对系数取均值与区间。
- **加权/误差模型（更炫技）**：把 `fan_vote_index` 的后验方差作为观测误差，做 errors-in-variables 近似。

### 6.2 验证策略（避免时间泄漏）

- 按 season 分组的交叉验证：leave-one-season-out。
- 稳健性对照：
  - 不用外生 proxy vs 用外生 proxy
  - 不含 pro 随机效应 vs 含 pro 随机效应

输出：泛化误差变化 + 解释性提升（系数稳定性）。

## 7. 结果解释模板（写给评委/制作人）

- **pro dancer 技术加成**：`u_pro` 的分布与区间；列出 Top pro / Bottom pro，并解释“这是在控制 celebrity 特征后的平均提升”。
- **pro dancer 人气加成**：`v_pro` 的分布；若与技术加成不一致，说明“某些舞伴更能带流量但不一定提升技术”。
- **行业差异**：例如 Athlete 在 `yJ` 上显著为正，但在 `yF` 上不显著或为负 → “技术强但人气未必强”。

## 8. 可视化与表格

- 系数/效应表：Q3 主模型系数 + 区间。
- pro 随机效应森林图（按 `u_pro`/`v_pro` 排序）。
- `yJ` vs `yF` 的散点与分组（industry），展示“技术-人气分离”。

## 9. 风险与应对

- Q1 不确定性较大时，Q3 对粉丝线的结论要谨慎：重点看“方向一致性 + 稳健性”，而不是单一显著性。
- 外生 proxy 覆盖不足：报告中只用于“有覆盖赛季”的补充分析，并明确标注样本范围。