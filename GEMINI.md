# Gemini CLI Context: MCM 2026 Problem C (DWTS)

This project is a mathematical modeling solution for the **2026 MCM Problem C**, focusing on the "Dancing with the Stars" (DWTS) television show.

## Project Overview

The project implements a reproducible modeling workflow to analyze DWTS seasons 1â€“34, addressing four main questions:
- **Q1 (Fan Vote Inference):** Estimating relative fan voting strength per contestant-week using a Sequential Monte Carlo (SMC) approach.
- **Q2 (Mechanism Comparison):** Counterfactual simulation of different voting/elimination rules (Rank vs. Percent) and the "Judge Save" mechanism.
- **Q3 (Impact Analysis):** Using mixed-effects models to analyze the impact of celebrity attributes and pro dancers on scores and fan votes.
- **Q4 (System Design):** Proposing and evaluating alternative voting systems based on fairness and excitement metrics.

### Key Technologies
- **Language:** Python 3.11+
- **Package Manager:** `uv`
- **Core Libraries:** `pandas`, `numpy`, `scipy`, `scikit-learn`, `statsmodels`
- **Visualization:** `matplotlib`, `seaborn`, `plotly`
- **Modeling:** Mixed-effects models, Monte Carlo simulation, SMC.

## Directory Structure

- `src/mcm2026/`: Main source code.
  - `core/`: Project-wide constants and path configurations.
  - `data/`: Data I/O and auditing logic.
  - `pipelines/`: Reproducible scripts for Q0 (Preprocessing) through Q4.
  - `pipelines/showcase/`: Appendix-only experimental/ML scripts.
- `data/`:
  - `raw/`: Read-only original datasets (e.g., `2026_MCM_Problem_C_Data.csv`).
  - `processed/`: Cleaned datasets (e.g., `dwts_weekly_panel.csv`) generated by Q0.
- `outputs/`: Generated artifacts for the paper.
  - `figures/`: Plots and charts.
  - `tables/`: CSV summaries of model results.
  - `predictions/`: Inferred fan vote shares.
- `docs/`:
  - `spec/`: Task requirements and architecture definitions.
  - `project_document/`: Detailed modeling plans for each question.
- `paper/`: LaTeX template and Chinese draft (`draft.md`).

## Building and Running

The project uses `uv` for dependency management and environment isolation.

### Setup
```powershell
# Create and sync the environment
uv sync

# Include optional groups (ml, dl, opt, web) if needed
uv sync --all-groups
```

### Execution
```powershell
# Run the full mainline pipeline (Q0 -> Q4)
uv run python run_all.py

# Run mainline + appendix/showcase outputs
uv run python run_all.py --showcase
```

### Quality Control
```powershell
# Run tests
uv run pytest

# Run linting
uv run ruff check .
```

## Development Conventions

- **Reproducibility:** All mainline results MUST be reproducible via `run_all.py`.
- **Data Integrity:** NEVER modify files in `data/raw/` or `data/processed/` manually. All transformations happen in `src/mcm2026/pipelines/mcm2026c_q0_build_weekly_panel.py`.
- **Mainline vs. Showcase:** Mainline pipelines (`pipelines/`) generate the primary evidence for the paper. Showcase scripts (`pipelines/showcase/`) are for sensitivity analysis or ML baselines and should not modify mainline output filenames.
- **Paths:** Always use the `mcm2026.core.paths` module to resolve file locations.
- **Documentation:** Refer to `docs/spec/task.md` for the global task specification and `docs/project_structure.md` for a summary of artifacts.
